{% extends "templates/base.html" %}
{%- from "templates/includes/navbar/navbar_items.html" import render_item -%}
{%- block head_include %}
<link rel="stylesheet" href="/assets/frappe/css/hljs-night-owl.css">
{% endblock -%}

{%- block navbar -%}

<nav class="navbar navbar-light navbar-expand-lg doc-navbar fixed-top">
	<div class="container-fluid doc-container">
		<div class="row no-gutters w-100">
			<div class="col-12 col-lg-2">
				<a class="navbar-brand" href="{{ url_prefix }}{{ home_page or "/" }}">
					{%- if brand_html -%}
					{{ brand_html }}
					{%- elif banner_image -%}
					<img src='{{ banner_image }}'>
					{%- else -%}
					<span>{{ (frappe.get_hooks("brand_html") or [_("Home")])[0] }}</span>
					{%- endif -%}
				</a>
			</div>
			<div class="col-12 col-lg-8">
				<div class="doc-search-container">
					<div class="website-search doc-search" id="search-container">
					</div>
					<button class="navbar-toggler" type="button"
						data-toggle="collapse"
						data-target="#navbarSupportedContent"
						aria-controls="navbarSupportedContent"
						aria-expanded="false"
						aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>
				</div>
			</div>
			<div class="col-12 col-lg-2">
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<ul class="navbar-nav">
						{%- set items = docs_navbar_items or [] -%}
						{%- for item in items -%}
						{{ render_item(item, parent=True) }}
						{%- endfor -%}
					</ul>
					{% include "templates/includes/web_sidebar.html" %}
				</div>
			</div>
		</div>
	</div>
</nav>
{%- endblock -%}

{% block content %}


{% macro container_attributes() -%}
id="page-{{ name or route | e }}" data-path="{{ pathname | e }}"
{%- if page_or_generator=="Generator" %}source-type="Generator" data-doctype="{{ doctype }}"{%- endif %}
{%- if source_content_type %}source-content-type="{{ source_content_type }}"{%- endif %}
{%- endmacro %}

<div class="container-fluid doc-layout doc-container">
	<div class="row no-gutters wiki-flex" {{ container_attributes() }}>
		{%- if  not no_sidebar -%}

			<div class="sidebar-column">
				<aside class="doc-sidebar">
					{% block page_sidebar %}
					{% include "templates/includes/web_sidebar.html" %}
					{% endblock %}
				</aside>
			</div>
		{%- endif -%}

		<div class="main-column doc-main">
			<div class="page-content-wrapper">
				{% block page_container %}
				<main>
					<div class="page_content page-content doc-content">
						{%- if add_breadcrumbs -%}
						{% include "wiki/doctype/wiki_page/templates/breadcrumbs.html" %}
						{%- endif -%}
						{%- block page_content -%}{%- endblock -%}
					</div>
				</main>
				{% endblock %}
			</div>
		</div>
		{%- if page_toc_html -%}
		<div class="page-toc d-none d-xl-block">
			{% block page_toc %}
			{% if page_toc_html %}
			<div class='list-unstyled'>
				<h5>On this page</h5>
				{{ page_toc_html }}
			</div>
			{% endif %}
			{% endblock %}
		</div>
		{%- endif -%}
	</div>
</div>

{% endblock %}
</div>
{%- block script -%}
<script>
	frappe.ready(() => {
		frappe.setup_search('#search-container', '{{ docs_search_scope or "" }}');

		$('.web-footer .container')
			.removeClass('container')
			.addClass('container-fluid doc-container');
		
			
			$('.ml-auto').append(`
			<li class="nav-item dropdown logged-in" id="website-post-login" data-label="website-post-login" style="">
				<a href="#" class="nav-link nav-avatar" data-toggle="dropdown" aria-expanded="false">
							<span class="user-image-wrapper">
								<span class="avatar avatar-medium filterable" title="Language:{{lang}}" data-filter="_assign,like,%null%">
								<div id = "lang_icon" class="avatar-frame standard-image" style="background-color: var(--green-avatar-bg); color: var(--green-avatar-color)">
										{{lang}}</div>
								</span>
							</span>
						</a>
						<ul class = "dropdown-menu dropdown-menu-right" id = "language_selector">
							<ul class="dropdown-menu dropdown-menu-right show" role="menu">
								<a id = "eng_lang" class="dropdown-item" href="#" rel="nofollow">English</a>
								<a id = "ar_lang" class="dropdown-item" href="#" rel="nofollow">عربي</a>
							</ul>
						</ul>
					</li>
						
						
						`)
			$("#eng_lang").click(()=>{
				change_lang("en")
			})
	
			$("#ar_lang").click(()=>{
				change_lang("ar")
			})
					   
		function change_lang(lang){
			console.log(lang)
			frappe.call({
				method: "one_fm.overrides.wiki_page.change_language",
				args: {
					lang: lang,
					user: frappe.session.user,
					
				},
				freeze: true,
				freeze_message: __("Changing  Language ..."),
				callback: function(r) {
						if(r.message){
							frappe.msgprint("Changing Langauge to "+lang)
							location.reload();
						}
						else{
							frappe.msgprint("An Error occured while changing languages, Please review the error log.")
						}
						
					}
				
			});
		}        		
				
		
		
				

	});
</script>
{%- endblock -%}
